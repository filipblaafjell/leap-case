version: 2

models:
  - name: int_state_unemployment
    description: >
      Cleans and standardizes state-level unemployment data from 
      Produces a monthly unemployment rate per U.S. state, ready to join with Amazon
      purchase data and macroeconomic indicators for regional economic analysis.

    meta:
      owner: data_engineering
      layer: intermediate
      tags: ["fred", "unemployment", "state", "intermediate"]

    config:
      materialized: "view"
      alias: "int_state_unemployment"

    columns:
      - name: state
        description: "U.S. state code in uppercase (standardized from raw FRED data)."
        tests:
          - not_null

      - name: month
        description: "Date truncated to month for consistent temporal join"
        tests:
          - not_null

      - name: unemployment_rate
        description: >
          Monthly unemployment rate % per state, rounded to two decimals.
        tests:
          - not_null
